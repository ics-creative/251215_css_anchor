<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <title>3. å¿œç”¨ - ãƒªã‚¹ãƒˆã®ã€Œä»Šè¦‹ã¦ã„ã‚‹è¦ç´ ã€ã‚’æŒ‡ã—ç¤ºã™</title>
  <link href="../base.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=DotGothic16&display=swap" rel="stylesheet">
  <style>
    :root {
      --spring-easing: cubic-bezier(0.17, 0.89, 0.32, 1.28);
    }

    .wrapper {
      font-family: "DotGothic16", sans-serif;
    }

    .book-list {
      display: flex;
      gap: 1rem;
    }

    .book {
      position: relative;
      display: grid;
      justify-content: center;
      align-items: start;
      grid-template-rows: 1fr auto;
      gap: 6px;
      width: 90px;
      height: 420px;
      padding: 2rem 0.3rem;
      border: 3px solid #222222;
      border-radius: 2px;
      background: #fffefc;
      box-shadow: 2px 2px 0 #111111;
      transition: translate 0.18s ease-out, border-color 0.2s ease-out;
    }

    .book:nth-of-type(1) {
      background-color: #7a729f;
    }

    .book:nth-of-type(2) {
      background-color: #a19450;
    }

    .book:nth-of-type(3) {
      background-color: #b27171;
    }

    .book:nth-of-type(4) {
      background-color: #516e85;
    }

    .book:nth-of-type(5) {
      background-color: #855175;
    }

    /* èƒŒè¡¨ç´™ã®ãƒ©ãƒ™ãƒ«ï¼ˆç¸¦æ›¸ãï¼‰ */
    .book-label {
      font-size: 1.1rem;
      color: #ffffff;
      letter-spacing: 0.25em;
      writing-mode: vertical-rl;
    }

    /* ã‚¯ãƒªãƒƒã‚¯ã—ã‚„ã™ã„ã‚ˆã†ã«ãƒ’ãƒƒãƒˆã‚¨ãƒªã‚¢æ‹¡å¼µ */
    .book::before {
      content: "";
      position: absolute;
      inset: -0.5rem;
    }

    .book:hover {
      translate: 0 -4px;
    }

    /* é¸æŠä¸­ã®æœ¬ï¼ˆè¦‹ãŸç›®ï¼‰ */
    .book.is-selected {
      border: 5px solid #f3f3f3;
    }

    /* â–¼ æŒ‡ã•ã—ãƒã‚¤ãƒ³ã‚¿ãƒ¼ï¼ˆé¸æŠä¸­ï¼ãƒ›ãƒãƒ¼ä¸­ã®æœ¬ã®çœŸä¸‹ã«ãã‚‹ï¼‰ */
    .pointer {
      position: absolute;
      top: calc(anchor(bottom) - 2rem);
      left: anchor(center);

      pointer-events: none;
      transition: left 0.45s var(--spring-easing), top 0.45s var(--spring-easing);
      rotate: -20deg;

      position-anchor: --selected-book; /* ğŸŒŸã©ã®ã‚¢ãƒ³ã‚«ãƒ¼ã‚’è¦‹ã‚‹ã‹æŒ‡å®š */

    }

    .pointer::before {
      content: "";
      display: block;
      width: 80px;
      height: 80px;
      background-image: url("./images/icon.png");
      background-repeat: no-repeat;
      background-position: center;
      background-size: contain;
      filter: drop-shadow(0 4px 4px rgba(120, 80, 130, 0.35));
    }
  </style>
</head>

<body>
<div class="wrapper">
  <div class="book-list">
    <button class="book is-selected">
      <span class="book-label">ã‹ã‚“ãŸã‚“ç‰‡ä»˜ã‘BOOK</span>
      <span class="book-label">å±±ç”°å±±ç”·</span>
    </button>
    <button class="book">
      <span class="book-label">ãŠã‚‚ã—ã‚ã„æŠ˜ã‚Šç´™</span>
      <span class="book-label">æŠ˜ç´™æŠ˜å¤ªéƒ</span>
    </button>
    <button class="book">
      <span class="book-label">é­šã«ã¤ã„ã¦ã®æœ¬</span>
      <span class="book-label">ã•ã‹ãªãŸã‚ã†</span>
    </button>
    <button class="book">
      <span class="book-label">ä¸‰é‡çœŒã®æ­´å²</span>
      <span class="book-label">å››æ—¥å¸‚èŠ±å­</span>
    </button>
    <button class="book">
      <span class="book-label">ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ãªã‚ã†</span>
      <span class="book-label">ICS</span>
    </button>
  </div>

  <!-- æŒ‡ã•ã—ãƒã‚¤ãƒ³ã‚¿ãƒ¼ï¼ˆã‚¢ãƒ³ã‚«ãƒ¼ã ã‘è¦‹ã¦å‹•ãï¼‰ -->
  <span aria-hidden="true" class="pointer"></span>
</div>

<script>
  const buttons = document.querySelectorAll(".book");
  let selectedBook = document.querySelector(".book.is-selected");
  // ä»Šãƒã‚¤ãƒ³ã‚¿ãƒ¼ãŒæŒ‡ã—ã¦ã„ã‚‹æœ¬
  let currentAnchorTarget = selectedBook;

  // ğŸŒŸãƒã‚¤ãƒ³ã‚¿ãƒ¼ã®å‚ç…§å…ˆï¼ˆã‚¢ãƒ³ã‚«ãƒ¼ï¼‰ã ã‘ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹é–¢æ•°
  const updateAnchor = (target) => {
    if (currentAnchorTarget) {
      currentAnchorTarget.style.anchorName = "";
    }
    currentAnchorTarget = target;
    if (currentAnchorTarget) {
      currentAnchorTarget.style.anchorName = "--selected-book";
    }
  };

  // åˆæœŸçŠ¶æ…‹ï¼šé¸æŠä¸­ã®æœ¬ã‚’æŒ‡ã™
  if (selectedBook) {
    updateAnchor(selectedBook);
  }

  buttons.forEach((button) => {
    // ã‚¯ãƒªãƒƒã‚¯ â†’ ã€Œé¸æŠä¸­ã®æœ¬ã€ã‚’æ›´æ–°
    button.addEventListener("click", () => {
      if (selectedBook) {
        selectedBook.classList.remove("is-selected");
      }
      selectedBook = button;
      selectedBook.classList.add("is-selected");
      updateAnchor(selectedBook);
    });

    // ãƒ›ãƒãƒ¼ãƒ»ãƒ•ã‚©ãƒ¼ã‚«ã‚¹é–‹å§‹ â†’ ä¸€æ™‚çš„ã«ã“ã®æœ¬ã‚’æŒ‡ã™
    const handleInteractionStart = () => {
      if (button !== currentAnchorTarget) {
        updateAnchor(button);
      }
    };

    // ãƒ›ãƒãƒ¼ãƒ»ãƒ•ã‚©ãƒ¼ã‚«ã‚¹çµ‚äº† â†’ ã¾ãŸã€Œé¸æŠä¸­ã®æœ¬ã€ã‚’æŒ‡ã™
    const handleInteractionEnd = () => {
      if (selectedBook) {
        updateAnchor(selectedBook);
      }
    };

    button.addEventListener("mouseenter", handleInteractionStart);
    button.addEventListener("focus", handleInteractionStart);
    button.addEventListener("mouseleave", handleInteractionEnd);
    button.addEventListener("blur", handleInteractionEnd);
  });
</script>
</body>
</html>
